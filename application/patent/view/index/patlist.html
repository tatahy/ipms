<!-- //module:asset, view:index/patList.html  -->

<div id="searchList" style="padding-top:10px;">	
	<div class="table-responsive">
		<table id="patListTbl" class="table table-bordered table-hover">
			<caption class="text-center" style="border-bottom:1px solid #eee;"><h4>专利信息列表&nbsp;<strong class="assType"></strong></h4></caption>
			<thead>
				<tr>
					<th class="text-center">序号</th>
					<th><a data-sort-name="topic">名称</a></th>
					<th><a data-sort-name="type">类型</a></th>
					<th><a data-sort-name="status">状态</a></th>
					<th><a data-sort-name="submitdate">提交日期</a></th>
					
					<th><a data-sort-name="author">撰写人</a></th>
					<th><a data-sort-name="inventor">发明人</a></th>
					<th><a data-sort-name="patowner">所有人</a></th>
					
					<th><a data-sort-name="dept">所属部门</a></th>
					<th><a data-sort-name="pronum">关联项目</a></th>
				</tr>
			</thead>
			<tbody><!-- 此处显示数据库查询后的数据集 -->
				{volist name="patList" id="vo" empty="暂时没有数据"}
				<tr data-show-id="{$vo.id}" class="text-right">
					<td class="text-center">{$i+($sortData.pageNum-1)*$sortData.listRows}</a></td>
					<td class="patInfo"><a href="{$home}/patent/index/patinfo/id/{$vo.id}" target="_blank" title="专利详情">{$vo.topic}</a></td>
					{// patent模块的Model层对‘pattype’字段输出值有处理，用getData方法可以得到‘type’字段在数据库中的值}
					<!-- <td>{$vo->getData('type')}</td> -->
					<td>{$vo.type}</td>
					<td>{$vo.status}</td>
					<td>{$vo.submitdate}</td>
					
					<td>{$vo.author}</td>
					<td>{$vo.inventor}</td>
					<td>{$vo.patowner}</td>
					
					<td>{$vo.dept}</td>
					<td class="proInfo">
						{foreach $vo.pronum as $n} 
							{if $n eq '无'}
								无
							{else /}
								<a href="#" data-toggle="tooltip">{$n}</a>
							{/if}
						{/foreach}
					</td>
				</tr>
				{/volist}
			</tbody>
		</table>		
	</div>
	
	<div id="divListRows" class="row text-right">
		<!-- // 分页变量 -->
		<div class="col-sm-10 text-right">{$pageSet->render()}</div>
						
		<div class="form-group form-group-sm col-sm-2">
			<span class="">每页记录行数：</span>
				<select class="form-control" id="listRows">
					<option value="5">5</option>
					<option value="10">10</option>
					<option value="20">20</option>
					<option value="50">50</option>
				</select>
						
		</div>
	</div>
</div>

<script>
<!--// var sData={$searchData}; -->
var sData=rqData.searchData;

searchResultNum={$searchResultNum};

initUrlObj(rqData.ent);
initEntList();

$(document).ready(function(){
	<!-- //表格每页显示记录行数 -->
	$('#listRows').val(rqData.sortData.listRows); 
	
	$('#listRows').change(function(){
		let listRows=$(this).val()*1;
		//排序有关的值向sortData汇集
		if(listRows){
			rqData.sortData.listRows=listRows;
			//分页从第一页开始
			rqData.sortData.pageNum=1;
		}
		//载入patList
		loadEntPeriodList();
	});	
	//排序
	$('#patListTbl thead a').click(function(){
		let sortName=$(this).data('sortName'),
			sortOrder=$(this).data('sortOrder');
		//排序有关的值向sortData汇集
		rqData.sortData.sortName=sortName;
		rqData.sortData.sortOrder=sortOrder;
		rqData.sortData.pageNum=1;
		//载入patList
		loadEntPeriodList();
	});	
	<!-- // 点击分页中的a，表格中的内容根据a中的属性值进行排序 -->
	$('#divListRows a').click(function(evt){
		// a所在分页页数
		let pageStr=$(this).text(),pageNum,
		//(li.active)所代表的页数
			pageNumActive=$('#divListRows li.active').children('span').text(),
			sortName=$('thead').find('.label').data('sortName');

		evt.preventDefault();
		//用"*"确保进行数字运算，而不是字符串
		switch(pageStr){
			case'»':
				pageNum=(pageNumActive*1+1);
			break;
			
			case'«':
				pageNum=(pageNumActive*1-1);
			break;
			
			default:
				pageNum=pageStr*1;
			break;
		}
		//排序、分页有关的值向sortData汇集
		if(pageNum){
			rqData.sortData.pageNum=pageNum;
		}
		//载入patList
		loadEntPeriodList();
	});
	//点击a后该行上底色
	$('#patListTbl tbody a').click(function(){
		rqData.sortData.showId=$(this).closest('tr').data('showId');
		setTrBgColor();
	});
	
});
</script>


