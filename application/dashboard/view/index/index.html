<!DOCTYPE html>
<html lang="en">
<head>
  <title>个人中心</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">  
 {/* TP5中的模板注释格式，多行。<!-- TP5的资源文件加载写法 -->
 内容不会出现在发送给浏览器的HTML文件中 */} 
  {css href="/home/res/css/bootstrap3.3.7.min.css" }
  {css href="/home/res/css/style.css" }
  {js href="/home/res/js/jquery1.12.4.min.js" }
  {js href="/home/res/js/bootstrap3.3.7.min.js" } 

  {// TP5中的模板注释格式，单行。} 
  {js href="/home/res/js/alert.min.js" }

  <style> 
  {// 实现nav固定在页面顶端效果的补充代码块，同时还需设置nav的data-offset-top="-3"防止鼠标单击页面时出现跳动 }

  .affix {
      top: 0;
      width: 100%;
  }

  .affix + .container-fluid {
      //padding-top: 70px;
  }
  
body {
  	/* Margin bottom by footer height */
  	margin-bottom: 60px;
}
  
.sidenav {
    padding-top: 10px;
	height: 100%;
    width: 0px;
    position: fixed;
    z-index: 0;
    top: 50px;
    left: 0;
	border:1px solid #e3e3e3;
    background-color: #f5f5f5;
    overflow: hidden;
    transition: 0.5s;
}

.sidenav.sidenav-show{
    width: 200px;
}


#main {
    padding-top: 55px;
	margin-left:0px;
	position: relative;
	//z-index: 0;
	transition: margin-left 0.5s;
}

#main.sidenav-show{
	margin-left:200px;
}

footer {
	//border:1px solid #e3e3e3;
	background-color:#f5f5f5; 
	position: fixed;
	/* 确保footer遮盖了分页显示*/
	z-index: 9;
	bottom:0;
	width: 100%;
	/* Set the fixed height of the footer here */
	height: 60px;
  
}

@media screen and (max-width: 767px) {
.sidenav.sidenav-show {
	/* 确保遮盖footer*/
	z-index: 10;
	height: 100%;
	border-radius: 3px;
	box-shadow:0px 0px 5px 2px #aaa;
	background-color:#ffffff;
}

#main.sidenav-show {
	margin-left:0px;
}

.sidenav a {font-size: 16px;}

footer {
	position: relative;
	background-color:#ffffff;
	border-top:1px solid #e3e3e3;
	padding-top:10px;
	margin-top:40px;
}

}
  
</style>
  
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top" data-spy="affix" data-offset-top="-3">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>                        
			</button>
			<!-- <a class="navbar-brand" href="#">撰写人：username&nbsp;<span class="glyphicon glyphicon-user"></span>&nbsp;个人中心</a> -->
			<span class="navbar-brand">
				<a class="aTab" href="#userInfo" data-toggle="tooltip" data-placement="bottom" title="个人中心"><strong>IPMS【{$username}】</strong>个人中心
				</a>
			</span>
		</div>
		<div class="collapse navbar-collapse" id="myNavbar">
			<ul class="nav navbar-nav navbar-right">
				<!-- <li id="liSearch" class=""> -->
				<!-- <form target="_blank" method="post" class="navbar-form" role="form" action="{$home}/search/index/searchresult"> -->
					<!-- <div class="form-group"> -->
						<!-- <label class="sr-only" for="searchword">关键词:</label> -->
						<!-- <input class="form-control" id="searchword" name="searchword" type="text" placeholder="关键词（题目/作者/部门) "size="30"> -->
						<!-- <input class="form-control hidden" id="htype" name="htype" type="text" value="all" > -->
					<!-- </div>	 -->
						<!-- <button type="submit" class="btn btn-default form-control"><span class="glyphicon glyphicon-search"></span>&nbsp;搜索</button> -->
						<!-- <a target="_blank" href="{$home}/search/index/index" data-toggle="tooltip" title="精细查找"  data-placement="bottom">更多...</a> -->
					
				<!-- </form> -->
				<!-- </li> -->
				<li><a href="{$home}/index/index/index"><span class="glyphicon glyphicon-home"></span>&nbsp;首页</a></li>
				<li id="liQuit"><a href="{$home}/index/index/logout"><span class="glyphicon glyphicon-log-out"></span>&nbsp;退出</a></li>
			</ul>
		</div>
	</div>
</nav>

<div id="mySideNav" class="sidenav">
	<div style="height:30px;border-bottom:1px solid #e3e3e3;"><button id="closeBtn" type="button" class="btn btn-link btn-lg pull-right" style="padding:0px 10px 0px 0px;"><span class="glyphicon glyphicon-chevron-left"></span><span style="font-size:16px;">隐藏</span></button>
	</div>
	<!-- nav 与 jQuery结合实现菜单栏导航效果-->
	<ul class="nav nav-pills nav-stacked">		
		<li class="active"><a class="aAnchor" href="#userInfo"><span class="glyphicon glyphicon-user"></span>&nbsp;个人信息管理</a></li>
		
		<li class="dropdown">
			<a class="dropdown-toggle" href="#" data-toggle="dropdown"><span class="glyphicon glyphicon-th-list"></span>&nbsp;事务处理<span id="issNumInprocess" class="badge"></span><span class="caret"></span></a>
			<ul class="dropdown-menu nav nav-pills nav-stacked pull-right">
				<li ><a class="aAnchor" href="#_ISST_PATS_INPROCESS"><span class="glyphicon glyphicon-wrench"></span>&nbsp;专利事务<span id="issPatNumInprocess" class="badge"></span></a></li>
				<li ><a class="aAnchor" href="#_ISST_THES_INPROCESS"><span class="glyphicon glyphicon-list"></span>&nbsp;论文事务<span id="issTheNumInprocess" class="badge"></span></a></li>
				<li ><a class="aAnchor" href="#_ISST_PROS_INPROCESS"><span class="glyphicon glyphicon-inbox"></span>&nbsp;项目事务<span id="issProNumInprocess" class="badge"></span></a></li>
			</ul>
		</li>	
		
		<li><a class="aAnchor" href="#_ATTS"><span class="glyphicon glyphicon-bookmark"></span>&nbsp;附件管理<span class="badge"></span></a></li>	
		<li><a class="aAnchor" href="#_ASSS_USUAL"><span class="glyphicon glyphicon-oil"></span>&nbsp;固定资产管理<span class="badge"></span></a></li>
		
		
	</ul>
		
</div>

<!-- pagewrap  -->
<div id="main" class="container-fluid">
	
	<button id="openBtn" type="button" class="btn btn-link btn-lg" style="padding:0;" title="显示控制台" data-placement="right"><span class="glyphicon glyphicon-dashboard"></span><span style="font-size:16px;">控制台</span></button>
  
  	<div id="divContent_load">
		<p class="text-center" style="font-size:28px;">加载中……</p>
	</div>
	
</div>

<!-- <footer> -->
    <!-- <div class="text-center"> -->
		<!-- <p style="margin-top:10px;">Powered by HY Copyright © {$year-1}-{$year}。推荐使用<a href="#">Chrome</a>、<a href="#">Firefox</a>浏览器<br>广州市光机电技术研究院（GZOME）. All rights reserved</p> -->
	<!-- </div> -->
<!-- </footer> -->

<!-- /pagewrap  -->

<script>
//归纳bootStrap3中的颜色相关属性
const bs3Color={
	//info
	info:{lab:'label label-info',btn:'btn-info',txt:'text-info',bg:'btn-info',alt:'alert-info',pan:'panel panel-info'},
	//success
	success:{lab:'label label-success',btn:'btn-success',txt:'text-success',bg:'btn-success',alt:'alert-success',pan:'panel panel-success'},
	//danger
	danger:{lab:'label label-danger',btn:'btn-danger',txt:'text-danger',bg:'btn-danger',alt:'alert-danger',pan:'panel panel-danger'},
	//warning
	warning:{lab:'label label-warning',btn:'btn-warning',txt:'text-warning',bg:'btn-warning',alt:'alert-warning',pan:'panel panel-warning'},
	//primary
	primary:{lab:'label label-primary',btn:'btn-primary',txt:'text-primary',bg:'btn-primary',pan:'panel panel-primary'},
	//default
	'default':{lab:'label label-default',btn:'btn-default'},
	//muted
	muted:{text:'text-muted'},
	//link
	link:{btn:'btn-link'}
};
//定义权限涉及的颜色属性
const authColor={
	common:{bs3:bs3Color.success,chi:'普通'},
	important:{bs3:bs3Color.warning,chi:'重要'},
	critical:{bs3:bs3Color.danger,chi:'关键'}
};
//权限模块核心属性，不允许修改/增加/删除属性（深冻结）
const authEntProp={$authEnt};


var setSideNavIssNumInprocess=(obj)=>{
	let issNum='',issPatNum='',issProNum='',issTheNum='';
	
	issPatNum=obj._PAT.S_INPROCESS;
	issProNum=obj._PRO.S_INPROCESS;
	issTheNum=obj._THE.S_INPROCESS;
	issNum=issPatNum+issProNum+issTheNum;
	$('#issNumInprocess').text(issNum);
	$('#issPatNumInprocess').text(issPatNum);
	$('#issTheNumInprocess').text(issProNum);
	$('#issProNumInprocess').text(issTheNum);
	
};

var showSideNavbar=(y)=>{
	if(y){
		//show
		$('#openBtn').hide();
		$('#mySideNav').addClass('sidenav-show');
		$('#main').addClass('sidenav-show');
	}else{
		$('#openBtn').show();
		$('#mySideNav').removeClass('sidenav-show');
		$('#main').removeClass('sidenav-show');
	}
};
//根据anchor值选择加载的文件
function loadFile(anchor){
	let	url='',
		typeStr=anchor.slice(1),
		enType=anchor.slice(1,5),
		aObj=$('a.aAnchor[href="'+anchor+'"]'),
		data='';
	
	if(aObj.length){
		aObj.tab('show');
	}else{
		$('a.aAnchor[href*='+anchor.slice(1,11)+']').tab('show');
	}
	<!-- aObj.length?aObj.tab('show'):$('a.aAnchor[href*='+enType+']').tab('show'); -->
		
	switch(enType){
		case '_ASS':
			url='{$home}/dashboard/asset/index';
			data={'sId':anchor,'assType':typeStr};
			break;
		case '_ISS':
			url='{$home}/dashboard/issue/index';
			data={'issEntName':anchor.slice(6,10),'IssStatus':'_INPROCESS'};
			break;	
		case '_ATT':
			url='{$home}/dashboard/attachment/index';
			break;
		default:
			url='{$home}/dashboard/index/userInfo';
			break;
	}
	
	$('#divContent_load').html('<p class="text-center" style="font-size:28px;">加载中……</p>').load(url,data); 
}

//利用自调用匿名函数立即执行的特点， 页面初始化
(function($){
	
	setSideNavIssNumInprocess({$numIssArr});
	loadFile(window.location.hash);
	// 激活tooltip
	$('[title]').tooltip();
	showSideNavbar(true);	

})(jQuery);

$(document).ready(function(){
	
	$('.aAnchor').click(function(el){
        el.preventDefault();
		let anchor=$(this).attr('href');
		//a所在li高亮
		$(this).tab('show');
		//改变页面的锚点值为a的href属性值
		window.location.hash=anchor;
		loadFile(anchor);    
    });	
	
	//显示SideNavbar
	$('#openBtn').click(function(){
		showSideNavbar(true);		
    });	
	//关闭SideNavbar
	$('#closeBtn').click(function(){
        showSideNavbar(false);		
    });			
});
</script>

</body>

</html>